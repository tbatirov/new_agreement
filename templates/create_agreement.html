{% extends "base.html" %}

{% block content %}
<!-- ... [previous content remains unchanged until line 143] ... -->

{% block scripts %}
<script src="{{ url_for('static', filename='js/voice.js') }}"></script>
<script src="{{ url_for('static', filename='js/template-loader.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const contentArea = document.getElementById('content');
    const previewContent = document.getElementById('previewContent');
    const previewSpinner = document.getElementById('previewSpinner');
    const analysisSection = document.getElementById('analysisSection');
    const templateMatchesSection = document.getElementById('templateMatchesSection');
    const templateMatches = document.getElementById('templateMatches');
    
    let suggestionTimeout = null;
    let analysisTimeout = null;

    function showPreviewSpinner(show = true) {
        if (show) {
            previewSpinner.classList.remove('d-none');
        } else {
            previewSpinner.classList.add('d-none');
        }
    }

    function createTemplateCard(template) {
        const confidencePercent = Math.round(template.confidence_score * 100);
        const confidenceClass = confidencePercent >= 80 ? 'success' : 
                              confidencePercent >= 60 ? 'warning' : 'danger';
        
        return `
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-body">
                        <h6 class="card-title">${template.template_name}</h6>
                        <div class="progress mb-2" style="height: 5px;">
                            <div class="progress-bar bg-${confidenceClass}" 
                                 style="width: ${confidencePercent}%"></div>
                        </div>
                        <p class="small text-muted mb-2">Match Confidence: ${confidencePercent}%</p>
                        <ul class="small mb-2">
                            ${template.matching_factors.map(factor => 
                                `<li>${factor}</li>`
                            ).join('')}
                        </ul>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary preview-template" 
                                    data-template-id="${template.template_id}">
                                Preview
                            </button>
                            <button class="btn btn-sm btn-outline-success use-template"
                                    data-template-id="${template.template_id}">
                                Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    function updateAnalysis(data) {
        // ... [rest of the updateAnalysis function remains unchanged] ...
    }

    // Get template suggestions based on user input
    contentArea.addEventListener('input', () => {
        // ... [rest of the input event handler remains unchanged] ...
    });
});
</script>
{% endblock %}
<!-- ... [rest of the file remains unchanged] ... -->
{% endblock %}

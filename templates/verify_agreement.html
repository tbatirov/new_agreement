{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-8 offset-md-2">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>{{ _('Document Verification Results') }}</h2>
            {% if is_valid %}
            <span class="badge bg-success fs-5">{{ _('Valid') }}</span>
            {% else %}
            <span class="badge bg-danger fs-5">{{ _('Invalid') }}</span>
            {% endif %}
        </div>

        <div class="alert alert-{{ 'success' if is_valid else 'danger' }}">
            {{ message }}
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">{{ _('Verification Details') }}</h5>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-4">{{ _('Agreement ID') }}</dt>
                    <dd class="col-sm-8">{{ agreement.id }}</dd>

                    <dt class="col-sm-4">{{ _('Verification Code') }}</dt>
                    <dd class="col-sm-8">
                        <code>{{ agreement.verification_code }}</code>
                    </dd>

                    <dt class="col-sm-4">{{ _('Created At') }}</dt>
                    <dd class="col-sm-8">{{ agreement.created_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}</dd>

                    <dt class="col-sm-4">{{ _('Last Verified') }}</dt>
                    <dd class="col-sm-8">
                        {% if agreement.last_verified_at %}
                            {{ agreement.last_verified_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}
                        {% else %}
                            {{ _('Not verified before') }}
                        {% endif %}
                    </dd>

                    <dt class="col-sm-4">{{ _('Document Hash') }}</dt>
                    <dd class="col-sm-8">
                        <code class="user-select-all">{{ verification_data.content_hash }}</code>
                    </dd>

                    <dt class="col-sm-4">{{ _('Status') }}</dt>
                    <dd class="col-sm-8">
                        <span class="badge bg-{{ 'success' if verification_data.status == 'signed' else 'info' }}">
                            {{ verification_data.status|title }}
                        </span>
                    </dd>

                    {% if verification_data.status == 'signed' %}
                    <dt class="col-sm-4">{{ _('Signed At') }}</dt>
                    <dd class="col-sm-8">{{ verification_data.signed_at }}</dd>
                    {% endif %}
                </dl>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">{{ _('Document Content') }}</h5>
            </div>
            <div class="card-body">
                {{ agreement.content|safe }}
            </div>
        </div>

        {% if agreement.signed_at %}
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">{{ _('Signatures') }}</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>{{ _('Party 1 Signature') }}</h6>
                        <img src="{{ agreement.signature1 }}" alt="Signature 1" class="signature-image">
                    </div>
                    <div class="col-md-6">
                        <h6>{{ _('Party 2 Signature') }}</h6>
                        <img src="{{ agreement.signature2 }}" alt="Signature 2" class="signature-image">
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="d-flex gap-2">
            <a href="{{ url_for('view_agreement', id=agreement.id) }}" class="btn btn-primary">
                {{ _('View Full Agreement') }}
            </a>
            <a href="{{ url_for('download_agreement', id=agreement.id) }}" class="btn btn-secondary">
                {{ _('Download PDF') }}
            </a>
        </div>
    </div>
</div>
{% endblock %}
